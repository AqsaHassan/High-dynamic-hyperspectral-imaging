r = [0.64, 0.33, 0.03]';
g = [0.30, 0.60,  0.1]';
b = [0.15, 0.06, 0.79]';
wpt = [0.3127, 0.3290, 0.3583]';
wpt = wpt./wpt(2);

S = [r, g, b] \ wpt;

T = [r, g, b] .* S';